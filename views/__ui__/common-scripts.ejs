<script type='text/javascript'>
    function xrxPrintInputJBA(jbaUserId, jbaAcctId){
        return xrxCreateTag('Input', '', xrxCreateTag('Accounting', '', xrxCreateTag('Jba', '',
                xrxCreateTag('JobAccountingUserId', '', jbaUserId) + xrxCreateTag('JobAccountId', '', jbaAcctId))));
    }

    function xrxPrintInputXSA(xsaUserId, xsaAcctType, xsaAcctId){
        return xrxCreateTag('Input', '', xrxCreateTag('Accounting', '', xrxCreateTag('Xsa', '',
                    xrxCreateTag('AccountUserId', '', xsaUserId) + xrxCreateTag('AccountTypeInfo', '',
                        xrxCreateTag('AccountType', '', xsaAcctType) + xrxCreateTag('AccountID', '', xsaAcctId)) +
                    xrxCreateTag('AccountBillingId', '', ''))));
    }

    function applyTheme(theme, target) {
        if (!theme || !theme.trim()) theme = 'darkgray';
        if (!target) {
            $('#action_bar').attr('class', 'xrx-action-bar xrx-background ' + theme);
            $('body').find('.xrx-widget').theme(theme);
        } else $(target).theme(theme);
    }

    function getSessionInformation(success, fail) {
        xrxSessionGetSessionInfo('http://127.0.0.1', function (request, response) {
            var data = xrxSessionParseGetSessionInfo(response), input = undefined;
            $('body').data('u', xrxGetElementValue(data, 'username'));
            var jba = xrxGetElementValue(data, 'jba');
            var xsa = xrxGetElementValue(data, 'xsa');
            if (jba && jba.trim()) {
                var jbaUserId = xrxGetElementValue(data, 'userID');
                var jbaAcctId = xrxGetElementValue(data, 'accountID');
                input = xrxPrintInputJBA(jbaUserId, jbaAcctId);
            }
            if (xsa && xsa.trim()) {
                var xsaUserId = xrxGetElementValue(data, 'userID');
                var xsaAcctType = xrxGetElementValue(data, 'AccountType');
                var xsaAcctId = xrxGetElementValue(data, 'AccountID');
                input = xrxPrintInputXSA(xsaUserId, xsaAcctType, xsaAcctId);
            }
            if (input) success(input);
            else fail();
        }, fail);
    }

    $(function() {
        $('body').data('h', $.screenHeight() < 481 ? 330 : 430);
        document.documentElement.style.overflow = 'hidden';
    });
</script>
